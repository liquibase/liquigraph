sudo: required
services:
  - docker
before_install:
  - docker pull neo4j/neo4j
language: java
jdk:
  - openjdk7
  - oraclejdk7
  - oraclejdk8
os:
  - linux
env:
  matrix:
    - NEO_VERSION=2.0.3
    - NEO_VERSION=2.0.5
    - NEO_VERSION=2.1.8
    - NEO_VERSION=2.2.6
      EXTRA_PROFILES=-Pwith-neo4j-io,with-docker
    - NEO_VERSION=2.3.0
      EXTRA_PROFILES=-Pwith-neo4j-io,with-docker

before_script: 
 - if [[ "${EXTRA_PROFILES}" =~ "with-docker" ]]; then docker run --detach --publish=7474:7474 --volume=$HOME/neo4j-data:/data --env=NEO4J_AUTH=neo4j/foobar neo4j/neo4j; fi
script: "mvn -T4 clean test -Dneo4j.version=${NEO_VERSION} ${EXTRA_PROFILES}"
after_success:
  - mvn clean test jacoco:report coveralls:report
